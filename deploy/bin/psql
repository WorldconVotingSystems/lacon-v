#!/usr/bin/env bash

WORKING_DIR=$(
    sudo docker inspect seattle-2025-web-1 |
        jq -r '.[0].Config.Labels["com.docker.compose.project.working_dir"]'
)

COMPOSE_FILE=$(
    sudo docker inspect seattle-2025-web-1 |
        jq -r '.[0].Config.Labels["com.docker.compose.project.config_files"]'
)

port=$(sudo docker compose -f $COMPOSE_FILE \
    port pgbouncer 5432 |
    cut -d: -f2)

PGPASSWORD=$(grep NOM_DB_PASSWORD $WORKING_DIR/.env | cut -d= -f2)
export PGPASSWORD
psql -h localhost -p $port -U postgres nominate
